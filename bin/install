#!/usr/bin/env bash

if [[ -z "$APP_ENV" ]]; then
    source .env
fi

if [[ "$1" == "init" ]]; then
    INSTALLATION_TYPE="$1"
    echo "--- INITIALIZATION -->"
    AFTER_INFO="<-- INITIALIZATION ---"
else
    INSTALLATION_TYPE="$APP_ENV"
    echo "--- INSTALLATION FOR $APP_ENV ENVIRONMENT -->"
    AFTER_INFO="<-- INSTALLATION FOR $APP_ENV ENVIRONMENT ---"
fi

case "$INSTALLATION_TYPE" in
    "dev")
        composer install
        php bin/console doctrine:schema:update --force
        ;;
    "init")
        php bin/console doctrine:schema:update --force
        ;;
    *)
        echo "Installation type has not been specified"
        ;;
esac

echo "$AFTER_INFO"
